---
title: "Doge years: Life and Times of Venetian doges"
author: "JJ Merelo"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Doge years: Life and Times of Venetian doges}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
bibliography: ../inst/doges.bib
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

## Introduction

Since doges were elected for life, it was apparently a conscious design by the electoral college to choose them in such a way that their terms would not last too long [@smith2021long]. Using data from `dogesr` [@dogesr], we will, in this vignette, see to what extent that happened and if there was some evolution during the time the Republic of Venice existed

## Set up

```{r load}
library(dogesr)
data("doges")
```

This will import the data from the `dogesr` package into the `data.doges` data frame. We are interested in the `Doges` and `Years` variables. Let's create a data frame out of that:

```{r years}
doges.all.years <- data.frame( doge = data.doges$Doge, years = data.doges$Years)
```

Several doges only were able to stay alive during the same year

```{r same.year}
knitr::kable(doges.all.years[doges.all.years$years == 0,]$doge, col.names=NULL)
```

And quite a few during 1 year or less

```{r one.year.or.less}
doges.one.year <- unique(doges.all.years[doges.all.years$years <= 1,])
knitr::kable(doges.one.year[order(doges.one.year$years),],col.names=NULL)
```

So it effectively looks like most doges effectively had a short shelf life. As a matter of fact, the doge that staid in power the longest was

```{r longest.doge}
knitr::kable(doges.all.years[which.max(doges.all.years$years),])
```

Francesco Foscari was elected when he was 50, defeating Pietro Loredan. After being in power for 34 years, he was the only doge forced to abdicate after the *serrata* or new rules electing the doges.

We can see whether this has any kind of influence using now several functions provided by the `dogesr` package next.

## Analyzing the evolution of the effective terms of the doges using `doges.years`

This can be analyzed a but further with a function provided by `dogesr`, `doges.years`. This filters part of the original data, leaving only data needed to work with the doges' terms (or years)

```{r using.doges.years}
doges.years.all <- doges.years()
doges.years.all$Century <- doges.years.all$Century +1 
knitr::kable(head(doges.years.all[order(-doges.years.all$Years),],10))
```

First thing we can note is that, among the top 10, there is only one, Leonardo Loredan, who was elected after the afore mentioned Francesco Foscari. This was, according to everyone, an unexpected event [@loredan], and he was chosen by the minimum needed to get elected. So he was really an outlier. The distribution in bins of 5 years, below, shows how infrequent was a term of more than 10 years.

> In fact, doges' years of ruling were as short as the life of the common dog.

```{r distribution}
library(ggplot2)
ggplot(doges.years.all, aes(x=Years))+geom_histogram(binwidth=5)
```

The distribution is skewed because it includes the first years of the institution. This is the distribution by centuries

```{r boxplot}
doges.years.all$Century <- as.factor(doges.years.all$Century)
ggplot(doges.years.all, aes(x=Century,y=Years))+geom_boxplot()
```

## References
